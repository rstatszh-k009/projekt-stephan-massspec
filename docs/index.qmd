---
title: "index"
format: html
editor: visual
author: "Stephan Walker"
---

```{r}
library(tidyverse)
```

```{r}
# read_csv2 für ";" geteilte Tabelle
cortison_import <- read_csv2(here::here("daten/raw/Cortison_csv.csv"))
hydrocortison_import <- read_csv2(here::here("daten/raw/Hydrocortison_csv.csv"))
```

# Einleitung

Im Rahmen des Nationalen Fremdstoffuntersuchungs Programm (NFUP) wurden in Proben von tierischen Lebensmitteln die Rückstände von Cortison und Hydrocortison gemessen. Beide Substanzen kommen natürlich in Produkten tierischer Herkunft vor. Für die Substanzen gibt es abgesehen von Milch keine Grenzwerte oder sonstige Beurteilungskriterien.

## Daten

Resultate der im Rahmen des NFUP durchgeführten Messungen durch die Abteilung Tierarzneimittel Analytik des Kantonalen Labors Zürich.

## Analyseziele

Es soll gezeigt werden wie sich die Konzentrationen von Cortison und Hydrocortison in den mehr als 2000 Messungen verteilen.

Gibt es Unterschiede zwischen einzelnen Matrizes? z.B Muskel und Leber

Gibt es Unterschiede zwischen verschiedenen Tierarten? z.B. Rinder und Schweine

# Datenaufbereitung

Daten zusammenführen und Spaltentietel ändern

```{r}
# merge mit all = TRUE um auch Proben mit nur einem Resultat in der Tabelle zu behalten
cortison_beide <- merge(cortison_import, hydrocortison_import, by="ProbenID", all = TRUE)
cortison_newname <- cortison_beide |> 
  rename(cortison_conc = ResultatResultat.x) |> 
  rename(hydrocortison_conc = ResultatResultat.y) |> 
  mutate(cortison_beide, ware = case_when
         (is_empty(ProbeWare.x) ~ ProbeWare.y,
          TRUE ~ ProbeWare.x)) |> 
  mutate(cortison_beide, datum = case_when(
    is_empty(ProbeErhebungsdatum.x) ~ ProbeErhebungsdatum.y,
    TRUE ~ ProbeErhebungsdatum.x
  ))

cortison_datum <-  mutate(cortison_newname, datum_date = as_date(datum, format = "%d.%m.%Y"))
                          
cortison_matrix <-  separate(cortison_datum, ware,c("tierart","matrix"))



```

Datum formatieren

```{r}
cortison_datum2 <- mutate(cortison_matrix, monat = month(datum_date))
jahreszeiten <- c("Frühling","Sommer","Herbst","Winter")
cortison_datum3 <- mutate(cortison_datum2,
                          jahreszeit = case_when(
                            monat == c(3,4,5) ~ "Frühling",
                            monat == c(6,7,8) ~ "Sommer",
                            monat == c(9,10,11) ~ "Herbst",
                            monat == c(1,2,12) ~ "Winter"
                          ))
```

```         
```

# Daten Visualisierung

```{r}
ggplot(data = cortison_datum3,
       mapping = aes(x = matrix,
                     y = hydrocortison_conc
                    
                     ))+
  geom_point()

```
